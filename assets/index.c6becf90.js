import{c as T}from"../deployer.js";function E(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const c=Object.getOwnPropertyDescriptor(r,o);c&&Object.defineProperty(e,o,c.get?c:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var f={},a={},w={};Object.defineProperty(w,"__esModule",{value:!0});function L(e){return window.btoa(e).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_")}w.base64urlEncode=L;function j(e){const t=e.replace(/-/g,"+").replace(/_/g,"/");let r=t;switch(t.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Illegal base64url string!")}return window.atob(r)}w.base64urlDecode=j;Object.defineProperty(a,"__esModule",{value:!0});const h=w;function A(e){return String.fromCharCode.apply(null,e)}a.arrayToString=A;function y(e){return e.split("").map(n=>n.charCodeAt(0))}a.stringToArray=y;function S(e){return y(h.base64urlDecode(e))}a.base64urlToArray=S;function k(e){return y(window.atob(e))}a.pemToArray=k;function P(e){return window.btoa(e.map(n=>String.fromCharCode(n)).join(""))}a.arrayToPem=P;function d(e){let n=0;for(let t=0;t<e.length;t+=1)n=n*256+e[t];return n}a.arrayToLen=d;function _(e){const n=[];for(let t=e;t>0;t>>=8)n.push(t&255);return n.reverse()}a.integerToOctet=_;function b(e){const n=_(e);let t;for(t=n.length;t<4;t+=1)n.unshift(0);return n}a.lenToArray=b;function B(e){const n=e.split(" "),t=n[0];if(t!=="ssh-rsa")throw new Error(`Unknown prefix: ${t}`);const r=k(n[1]),o=d(r.splice(0,4)),c=A(r.splice(0,o));if(c!=="ssh-rsa")throw new Error(`Unknown key type: ${c}`);const s=d(r.splice(0,4)),i=r.splice(0,s),u=d(r.splice(0,4)),l=r.splice(0,u);return{type:c,exponent:i,key:l,name:n[2]}}a.decodePublicKey=B;function g(e){return e[0]>>7===1?[0,...e]:e}a.checkHighestBit=g;function O(e){return{type:"ssh-rsa",exponent:g(y(h.base64urlDecode(e.e))),name:"name",key:g(y(h.base64urlDecode(e.n)))}}function D(e,n){const t=O(e);t.name=n;const r=b(t.key.length),o=b(t.exponent.length),s=[...b(t.type.length),...y(t.type),...o,...t.exponent,...r,...t.key],i=P(s);return`${t.type} ${i} ${t.name}`}a.encodePublicKey=D;function x(e){let n=[];return e>>7?(n=_(e),n.unshift(128+n.length)):n.push(e),n}a.asnEncodeLen=x;function C(e){const t=["n","e","d","p","q","dp","dq","qi"].map(s=>{const i=g(y(h.base64urlDecode(e[s]))),u=x(i.length);return[2].concat(u,i)});let r=[2,1,0];r=r.concat(...t);const o=x(r.length),c=[48].concat(o,r);return P(c)}a.encodePrivateKey=C;var K={};Object.defineProperty(K,"__esModule",{value:!0});function $(e,n=72){let t="";for(let r=0;r<e.length;r+=n)t+=e.slice(r,r+n),t+=`
`;return t}K.wrapString=$;var I=T&&T.__awaiter||function(e,n,t,r){function o(c){return c instanceof t?c:new t(function(s){s(c)})}return new(t||(t=Promise))(function(c,s){function i(p){try{l(r.next(p))}catch(m){s(m)}}function u(p){try{l(r.throw(p))}catch(m){s(m)}}function l(p){p.done?c(p.value):o(p.value).then(i,u)}l((r=r.apply(e,n||[])).next())})};Object.defineProperty(f,"__esModule",{value:!0});const v=a,M=K,U=!0;function q(e){return`-----BEGIN RSA PRIVATE KEY-----
${e}-----END RSA PRIVATE KEY-----`}function R(e){let n="";const t=new Uint8Array(e),r=t.byteLength;for(let o=0;o<r;o+=1)n+=String.fromCharCode(t[o]);return window.btoa(n)}var N=f.arrayBufferToBase64=R;function G({alg:e,size:n,name:t,hash:r}){return I(this,void 0,void 0,function*(){const o=yield window.crypto.subtle.generateKey({name:e,modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:{name:r}},U,["sign","verify"]),c=window.crypto.subtle.exportKey("jwk",o.privateKey).then(v.encodePrivateKey).then(M.wrapString).then(q),s=window.crypto.subtle.exportKey("jwk",o.publicKey).then(l=>v.encodePublicKey(l,t)),[i,u]=yield Promise.all([c,s]);return{privateKey:i,publicKey:u}})}var H=f.generateKeyPair=G;const Y=E({__proto__:null,arrayBufferToBase64:N,generateKeyPair:H,default:f},[f]);export{Y as i};
