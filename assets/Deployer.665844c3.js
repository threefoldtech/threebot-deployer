import{S as ne,i as ae,s as re,f as ie,h as E,m as Y,F as ge,n as J,O as I,P as oe,Q as N,R as se,k as H,j as M,T as L,p as q,r as W,B as te,t as j,q as z,U as F,u as _,V as K,W as me,I as Ie,o as be,X as ve,v as ut,x as ue,c as De,y as pe,C as ke,D as he,E as Ze,Y as fe,z as Qe,A as Ae,Z as ft,N as ct,$ as dt,a0 as we,a1 as mt}from"../deployer.js";import{g as Be,i as pt,f as ht,a as gt,d as P,n as bt,b as ce,M as yt,c as wt,e as _t,h as St,j as de,k as vt}from"./Modal.dafbaf76.js";import{a as kt,c as Ct,t as It}from"./toNumber.2d75f519.js";const Xe={Asia:["Afghanistan","Armenia","Azerbaijan","Bahrain","Bangladesh","Bhutan","Brunei Darussalam","Cambodia","China","Georgia","Hong Kong","India","Indonesia","Iran (Islamic Republic of)","Iraq","Israel","Japan","Jordan","Kazakhstan","Kuwait","Kyrgyzstan","Lao People's Democratic Republic","Lebanon","Macao","Malaysia","Maldives","Mongolia","Myanmar","Nepal","Korea (Democratic People's Republic of)","Oman","Pakistan","Palestine, State of","Philippines","Qatar","Saudi Arabia","Singapore","Korea (Republic of)","Sri Lanka","Syrian Arab Republic","Taiwan","Tajikistan","Thailand","Timor-Leste","Turkey","Turkmenistan","United Arab Emirates","Uzbekistan","Vietnam","Yemen"],Europe:["\xC5land Islands","Albania","Andorra","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Faroe Islands","Finland","France","Germany","Gibraltar","Greece","Guernsey","Vatican City","Hungary","Iceland","Ireland","Isle of Man","Italy","Jersey","Latvia","Liechtenstein","Lithuania","Luxembourg","North Macedonia","Malta","Moldova (Republic of)","Monaco","Montenegro","Netherlands","Norway","Poland","Portugal","Republic of Kosovo","Romania","Russian Federation","San Marino","Serbia","Slovakia","Slovenia","Spain","Svalbard and Jan Mayen","Sweden","Switzerland","Ukraine","United Kingdom of Great Britain and Northern Ireland"],Africa:["Algeria","Angola","Benin","Botswana","British Indian Ocean Territory","Burkina Faso","Burundi","Cameroon","Cabo Verde","Central African Republic","Chad","Comoros","Congo","Congo (Democratic Republic of the)","Djibouti","Egypt","Equatorial Guinea","Eritrea","Ethiopia","French Southern Territories","Gabon","Gambia","Ghana","Guinea","Guinea-Bissau","Ivory Coast","Kenya","Lesotho","Liberia","Libya","Madagascar","Malawi","Mali","Mauritania","Mauritius","Mayotte","Morocco","Mozambique","Namibia","Niger","Nigeria","R\xE9union","Rwanda","Saint Helena, Ascension and Tristan da Cunha","Sao Tome and Principe","Senegal","Seychelles","Sierra Leone","Somalia","South Africa","Sudan","South Sudan","Swaziland","Tanzania, United Republic of","Togo","Tunisia","Uganda","Western Sahara","Zambia","Zimbabwe"],Oceania:["American Samoa","Australia","Christmas Island","Cocos (Keeling) Islands","Cook Islands","Fiji","French Polynesia","Guam","Kiribati","Marshall Islands","Micronesia (Federated States of)","Nauru","New Caledonia","New Zealand","Niue","Norfolk Island","Northern Mariana Islands","Palau","Papua New Guinea","Pitcairn","Samoa","Solomon Islands","Tokelau","Tonga","Tuvalu","Vanuatu","Wallis and Futuna"],Americas:["Anguilla","Antigua and Barbuda","Argentina","Aruba","Bahamas","Barbados","Belize","Bermuda","Bolivia (Plurinational State of)","Bonaire, Sint Eustatius and Saba","Brazil","United States Minor Outlying Islands","Virgin Islands (British)","Virgin Islands (U.S.)","Canada","Cayman Islands","Chile","Colombia","Costa Rica","Cuba","Cura\xE7ao","Dominica","Dominican Republic","Ecuador","El Salvador","Falkland Islands (Malvinas)","French Guiana","Greenland","Grenada","Guadeloupe","Guatemala","Guyana","Haiti","Honduras","Jamaica","Martinique","Mexico","Montserrat","Nicaragua","Panama","Paraguay","Peru","Puerto Rico","Saint Barth\xE9lemy","Saint Kitts and Nevis","Saint Lucia","Saint Martin (French part)","Saint Pierre and Miquelon","Saint Vincent and the Grenadines","Sint Maarten (Dutch part)","South Georgia and the South Sandwich Islands","Suriname","Trinidad and Tobago","Turks and Caicos Islands","United States of America","Uruguay","Venezuela (Bolivarian Republic of)"]};function Re(e){let t,a,n,r,i,o,s,f,h,u,l,p,v,C,D;return a=new e[2]({props:{label:"Threebot Deployer Instance Name",sublabel:"Instance name is used for managing the deployed instance and to create a subdomain",placeholder:"Instance name is used for managing the deployed instance and to create a subdomain",controller:e[1].get("name")}}),r=new e[2]({props:{label:"Flist",placeholder:"Instance name is used for managing the deployed instance and to create a subdomain",controller:e[1].get("flist")}}),o=new e[2]({props:{controller:e[1].get("entryPoint"),label:"Entry Point",placeholder:"/init.sh"}}),f=new e[3]({props:{label:"Region",controller:e[1].get("region"),options:[{label:"All",value:null},...Object.keys(Xe).map(Tt)]}}),l=new e[4]({props:{label:"<strong><a href='https://library.threefold.me/info/threefold/#/tfgrid/pricing/threefold__certified_farming' target='_blank' class='mr-1'>Certified</a>Hardware</strong>",controller:e[1].get("certified")}}),{c(){t=M("section"),L(a.$$.fragment),n=q(),L(r.$$.fragment),i=q(),L(o.$$.fragment),s=q(),L(f.$$.fragment),h=q(),u=M("div"),L(l.$$.fragment),p=q(),v=M("b-tooltip"),C=M("div"),C.innerHTML='<b-icon icon="fa-solid fa-circle-question"></b-icon>',W(C,"margin-top","6px"),te(v,"tooltip","Deploy your instance on a Certified 3Node. Certified 3Nodes come with greater levels of security and performance along with other benefits."),te(v,"flow","right"),j(v,"is-hidden-touch",!0),z(u,"class","is-flex"),W(t,"display",e[0]?"initial":"none")},m(d,b){E(d,t,b),F(a,t,null),_(t,n),F(r,t,null),_(t,i),F(o,t,null),_(t,s),F(f,t,null),_(t,h),_(t,u),F(l,u,null),_(u,p),_(u,v),_(v,C),D=!0},p(d,b){const A={};b&2&&(A.controller=d[1].get("name")),a.$set(A);const T={};b&2&&(T.controller=d[1].get("flist")),r.$set(T);const B={};b&2&&(B.controller=d[1].get("entryPoint")),o.$set(B);const y={};b&2&&(y.controller=d[1].get("region")),f.$set(y);const w={};b&2&&(w.controller=d[1].get("certified")),l.$set(w),b&1&&W(t,"display",d[0]?"initial":"none")},i(d){D||(I(a.$$.fragment,d),I(r.$$.fragment,d),I(o.$$.fragment,d),I(f.$$.fragment,d),I(l.$$.fragment,d),D=!0)},o(d){N(a.$$.fragment,d),N(r.$$.fragment,d),N(o.$$.fragment,d),N(f.$$.fragment,d),N(l.$$.fragment,d),D=!1},d(d){d&&H(t),K(a),K(r),K(o),K(f),K(l)}}}function At(e){let t,a,n=e[1]&&Re(e);return{c(){n&&n.c(),t=ge(),this.c=J},m(r,i){n&&n.m(r,i),E(r,t,i),a=!0},p(r,[i]){r[1]?n?(n.p(r,i),i&2&&I(n,1)):(n=Re(r),n.c(),I(n,1),n.m(t.parentNode,t)):n&&(oe(),N(n,1,1,()=>{n=null}),se())},i(r){a||(I(n),a=!0)},o(r){N(n),a=!1},d(r){n&&n.d(r),r&&H(t)}}}const Tt=e=>({label:e,value:e});function Mt(e,t,a){const{Input:n,Select:r,CheckBox:i}=window.tfSvelteBulmaWc;let{show:o}=t,{deployer:s}=t;return e.$$set=f=>{"show"in f&&a(0,o=f.show),"deployer"in f&&a(1,s=f.deployer)},[o,s,n,r,i]}class xe extends ne{constructor(t){super(),ae(this,{target:this.shadowRoot,props:ie(this.attributes),customElement:!0},Mt,At,re,{show:0,deployer:1},null),t&&(t.target&&E(t.target,this,t.anchor),t.props&&(this.$set(t.props),Y()))}static get observedAttributes(){return["show","deployer"]}get show(){return this.$$.ctx[0]}set show(t){this.$$set({show:t}),Y()}get deployer(){return this.$$.ctx[1]}set deployer(t){this.$$set({deployer:t}),Y()}}customElements.define("tf-basic-tab",xe);var Nt=kt,Dt=function(){return Nt.Date.now()},Bt=Dt,Rt=Ct,_e=Bt,Pe=It,Pt="Expected a function",Et=Math.max,$t=Math.min;function qt(e,t,a){var n,r,i,o,s,f,h=0,u=!1,l=!1,p=!0;if(typeof e!="function")throw new TypeError(Pt);t=Pe(t)||0,Rt(a)&&(u=!!a.leading,l="maxWait"in a,i=l?Et(Pe(a.maxWait)||0,t):i,p="trailing"in a?!!a.trailing:p);function v(w){var S=n,c=r;return n=r=void 0,h=w,o=e.apply(c,S),o}function C(w){return h=w,s=setTimeout(b,t),u?v(w):o}function D(w){var S=w-f,c=w-h,g=t-S;return l?$t(g,i-c):g}function d(w){var S=w-f,c=w-h;return f===void 0||S>=t||S<0||l&&c>=i}function b(){var w=_e();if(d(w))return A(w);s=setTimeout(b,D(w))}function A(w){return s=void 0,p&&n?v(w):(n=r=void 0,o)}function T(){s!==void 0&&clearTimeout(s),h=0,n=f=r=s=void 0}function B(){return s===void 0?o:A(_e())}function y(){var w=_e(),S=d(w);if(n=arguments,r=this,f=w,S){if(s===void 0)return C(f);if(l)return clearTimeout(s),s=setTimeout(b,t),v(f)}return s===void 0&&(s=setTimeout(b,t)),o}return y.cancel=T,y.flush=B,y}var Ut=qt;function Ee(e){let t,a,n,r;return t=new e[6]({props:{label:"Select farm id",options:[{label:"All",value:null},...e[3].map($e)],controller:e[8],loading:!e[5],disabled:!e[5]}}),n=new e[6]({props:{label:"Select Node ID",placeholder:"Select Node ID to deploy",validation:!e[4]&&!e[1].pending,loading:e[4]||e[1].pending,disabled:e[4]||e[1].pending,controller:e[7],options:e[2].map(qe),hint:e[1].pending?"Checking node status (Up/Down)...":void 0}}),{c(){L(t.$$.fragment),a=q(),L(n.$$.fragment)},m(i,o){F(t,i,o),E(i,a,o),F(n,i,o),r=!0},p(i,o){const s={};o&8&&(s.options=[{label:"All",value:null},...i[3].map($e)]),o&32&&(s.loading=!i[5]),o&32&&(s.disabled=!i[5]),t.$set(s);const f={};o&18&&(f.validation=!i[4]&&!i[1].pending),o&18&&(f.loading=i[4]||i[1].pending),o&18&&(f.disabled=i[4]||i[1].pending),o&4&&(f.options=i[2].map(qe)),o&2&&(f.hint=i[1].pending?"Checking node status (Up/Down)...":void 0),n.$set(f)},i(i){r||(I(t.$$.fragment,i),I(n.$$.fragment,i),r=!0)},o(i){N(t.$$.fragment,i),N(n.$$.fragment,i),r=!1},d(i){K(t,i),i&&H(a),K(n,i)}}}function Gt(e){let t,a,n=e[0]&&Ee(e);return{c(){n&&n.c(),t=ge(),this.c=J},m(r,i){n&&n.m(r,i),E(r,t,i),a=!0},p(r,[i]){r[0]?n?(n.p(r,i),i&1&&I(n,1)):(n=Ee(r),n.c(),I(n,1),n.m(t.parentNode,t)):n&&(oe(),N(n,1,1,()=>{n=null}),se())},i(r){a||(I(n),a=!0)},o(r){N(n),a=!1},d(r){n&&n.d(r),r&&H(t)}}}const $e=e=>({label:`${e.name}(${e.farmID})`,value:e.farmID}),qe=e=>({label:`Node ID(${e.nodeId})`,value:e.nodeId});function Lt(e,t,a){let n,r;const{Select:i}=window.tfSvelteBulmaWc,{fb:o,FormGroup:s,validators:f}=window.tfSvelteRxForms,{default:h}=window.tfgridGql;let{deployer:u}=t;const l=o.control(null,[Be,f.required("Node ID is required.")],[pt]);me(e,l,y=>a(9,r=y));const p=o.control(null,[Be]);let v=[],C=[];const D=Ut(async y=>{a(2,v=[]),a(4,b=!0),y.setDisabled(!0);const w=l.value;l.setValue(null);const S=y.value;if(delete S.region,S.mru/=1024,a(2,v=await ht(u.value.mnemonic,S)),p.value&&(a(2,v=v.filter(g=>g.farmId===p.value)),v.length===0)){const g=`No nodes satisfy the requirement with farm(${p.value}) were found.`;l.setValue(null,{error:g}),p.getValue().error!==g&&p.setValue(p.value,{error:g})}if(y.get("certified").value&&(a(2,v=v.filter(g=>g.certificationType==="Certified")),v.length===0)){const g="No certified nodes were found.";l.setValue(null,{error:g}),y.get("certified").getValue().error!==g&&y.get("certified").setValue(!0,{error:g})}const c=y.get("region").value;if(c!==null){const g=Xe[c];if(a(2,v=v.filter(G=>g==null?void 0:g.includes(G.location.country))),v.length===0){const G=`No nodes were found in '${c}' region.`;l.setValue(null,{error:G}),y.get("region").getValue().error!==G&&y.get("region").setValue(c,{error:G})}}v.some(g=>g.nodeId===w)?l.setValue(w):v.length>0&&l.setValue(v[0].nodeId),l.markAsTouched(),l.markAsDirty(),a(4,b=!1),y.setDisabled(!1)},1500);async function d(){const y=new h(window.config.network),w={updatedAt_gt:Date.now()-1*60*60*1e3},S=["nodeID_ASC"],{totalCount:c}=await y.nodesConnection({totalCount:!0},{where:w,orderBy:S});a(3,C=c===0?[]:await y.nodes({farmID:!0},{where:w,orderBy:S,limit:c}).then(g=>y.farms({name:!0,farmID:!0},{where:{farmID_in:Array.from(new Set(g.map(G=>G.farmID)))},orderBy:["farmID_ASC"]}))),a(5,A=!0),D(B)}let b=!1,A=!1,T,B;return Ie(()=>T==null?void 0:T()),be(async()=>{await d(),B=new s({cru:u.get("cpu"),mru:u.get("memory"),sru:u.get("disk"),publicIPs:u.get("ipv4"),region:u.get("region"),certified:u.get("certified"),farmId:p}),T=B.subscribe(()=>{A&&(a(4,b=!0),u.get("nodeId").setValue(null),D(B))})}),e.$$set=y=>{"deployer"in y&&a(0,u=y.deployer)},e.$$.update=()=>{e.$$.dirty&512&&a(1,n=r),e.$$.dirty&3&&u&&n.valid&&(u.get("nodeId").setValue(n.value),u.get("nodeId").markAsDirty())},[u,n,v,C,b,A,i,l,p,r]}class et extends ne{constructor(t){super(),ae(this,{target:this.shadowRoot,props:ie(this.attributes),customElement:!0},Lt,Gt,re,{deployer:0},null),t&&(t.target&&E(t.target,this,t.anchor),t.props&&(this.$set(t.props),Y()))}static get observedAttributes(){return["deployer"]}get deployer(){return this.$$.ctx[0]}set deployer(t){this.$$set({deployer:t}),Y()}}customElements.define("tf-select-node-id",et);function Ue(e){let t,a;return t=new e[2]({props:{label:"Select Gateway Node",placeholder:"Please select a gateway node",controller:e[0].get("gateway"),options:e[1].map(Ge)}}),{c(){L(t.$$.fragment)},m(n,r){F(t,n,r),a=!0},p(n,r){const i={};r&1&&(i.controller=n[0].get("gateway")),r&2&&(i.options=n[1].map(Ge)),t.$set(i)},i(n){a||(I(t.$$.fragment,n),a=!0)},o(n){N(t.$$.fragment,n),a=!1},d(n){K(t,n)}}}function Ft(e){let t,a,n=e[0]&&Ue(e);return{c(){n&&n.c(),t=ge(),this.c=J},m(r,i){n&&n.m(r,i),E(r,t,i),a=!0},p(r,[i]){r[0]?n?(n.p(r,i),i&1&&I(n,1)):(n=Ue(r),n.c(),I(n,1),n.m(t.parentNode,t)):n&&(oe(),N(n,1,1,()=>{n=null}),se())},i(r){a||(I(n),a=!0)},o(r){N(n),a=!1},d(r){n&&n.d(r),r&&H(t)}}}const Ge=([e,t])=>({label:e,value:t});function Kt(e,t,a){const{Select:n}=window.tfSvelteBulmaWc;let{deployer:r}=t,i=[];return be(async()=>{const o=await gt(r.value.mnemonic);a(1,i=Object.keys(o).map(s=>[o[s].domain,s+":"+o[s].domain])),i.length&&r.get("gateway").setValue(i[0][1])}),e.$$set=o=>{"deployer"in o&&a(0,r=o.deployer)},[r,i,n]}class tt extends ne{constructor(t){super(),ae(this,{target:this.shadowRoot,props:ie(this.attributes),customElement:!0},Kt,Ft,re,{deployer:0},null),t&&(t.target&&E(t.target,this,t.anchor),t.props&&(this.$set(t.props),Y()))}static get observedAttributes(){return["deployer"]}get deployer(){return this.$$.ctx[0]}set deployer(t){this.$$set({deployer:t}),Y()}}customElements.define("tf-select-gateway",tt);function Le(e){let t,a,n,r,i,o,s,f,h,u,l,p,v,C,D;return a=new e[2]({props:{label:"CPU (vCores)",placeholder:"CPU in vCores",type:"number",controller:e[1].get("cpu")}}),r=new e[2]({props:{label:"Memory (MB)",placeholder:"Memory in MB",type:"number",controller:e[1].get("memory")}}),o=new e[2]({props:{label:"Disk (GB)",placeholder:"Disk in GB",type:"number",controller:e[1].get("disk")}}),f=new e[3]({props:{label:"Planetary Network",controller:e[1].get("planetary")}}),u=new e[3]({props:{label:"Public IPv4",controller:e[1].get("ipv4")}}),p=new tt({props:{deployer:e[1]}}),C=new et({props:{deployer:e[1]}}),{c(){t=M("section"),L(a.$$.fragment),n=q(),L(r.$$.fragment),i=q(),L(o.$$.fragment),s=q(),L(f.$$.fragment),h=q(),L(u.$$.fragment),l=q(),L(p.$$.fragment),v=q(),L(C.$$.fragment),W(t,"display",e[0]?"initial":"none")},m(d,b){E(d,t,b),F(a,t,null),_(t,n),F(r,t,null),_(t,i),F(o,t,null),_(t,s),F(f,t,null),_(t,h),F(u,t,null),_(t,l),F(p,t,null),_(t,v),F(C,t,null),D=!0},p(d,b){const A={};b&2&&(A.controller=d[1].get("cpu")),a.$set(A);const T={};b&2&&(T.controller=d[1].get("memory")),r.$set(T);const B={};b&2&&(B.controller=d[1].get("disk")),o.$set(B);const y={};b&2&&(y.controller=d[1].get("planetary")),f.$set(y);const w={};b&2&&(w.controller=d[1].get("ipv4")),u.$set(w);const S={};b&2&&(S.deployer=d[1]),p.$set(S);const c={};b&2&&(c.deployer=d[1]),C.$set(c),b&1&&W(t,"display",d[0]?"initial":"none")},i(d){D||(I(a.$$.fragment,d),I(r.$$.fragment,d),I(o.$$.fragment,d),I(f.$$.fragment,d),I(u.$$.fragment,d),I(p.$$.fragment,d),I(C.$$.fragment,d),D=!0)},o(d){N(a.$$.fragment,d),N(r.$$.fragment,d),N(o.$$.fragment,d),N(f.$$.fragment,d),N(u.$$.fragment,d),N(p.$$.fragment,d),N(C.$$.fragment,d),D=!1},d(d){d&&H(t),K(a),K(r),K(o),K(f),K(u),K(p),K(C)}}}function Vt(e){let t,a,n=e[1]&&Le(e);return{c(){n&&n.c(),t=ge(),this.c=J},m(r,i){n&&n.m(r,i),E(r,t,i),a=!0},p(r,[i]){r[1]?n?(n.p(r,i),i&2&&I(n,1)):(n=Le(r),n.c(),I(n,1),n.m(t.parentNode,t)):n&&(oe(),N(n,1,1,()=>{n=null}),se())},i(r){a||(I(n),a=!0)},o(r){N(n),a=!1},d(r){n&&n.d(r),r&&H(t)}}}function Ht(e,t,a){const{Input:n,CheckBox:r}=window.tfSvelteBulmaWc;let{show:i}=t,{deployer:o}=t,s;return Ie(()=>s==null?void 0:s()),be(function f(){o||requestAnimationFrame(f)}),e.$$set=f=>{"show"in f&&a(0,i=f.show),"deployer"in f&&a(1,o=f.deployer)},[i,o,n,r]}class nt extends ne{constructor(t){super(),ae(this,{target:this.shadowRoot,props:ie(this.attributes),customElement:!0},Ht,Vt,re,{show:0,deployer:1},null),t&&(t.target&&E(t.target,this,t.anchor),t.props&&(this.$set(t.props),Y()))}static get observedAttributes(){return["show","deployer"]}get show(){return this.$$.ctx[0]}set show(t){this.$$set({show:t}),Y()}get deployer(){return this.$$.ctx[1]}set deployer(t){this.$$set({deployer:t}),Y()}}customElements.define("tf-advanced-tab",nt);function Fe(e,t,a){const n=e.slice();return n[2]=t[a].src,n[7]=t[a].alt,n[8]=t[a].url,n[10]=a,n}function Ot(e){let t,a,n,r,i,o,s,f=e[3],h=[];for(let u=0;u<f.length;u+=1)h[u]=Ke(Fe(e,f,u));return{c(){t=M("h4"),t.innerHTML='Scan the QRcode using <a target="_blank" href="https://library.threefold.me/info/threefold#/tokens/threefold__threefold_connect" rel="noreferrer">ThreeFold Connect</a> to fund your account',a=q(),n=M("div"),r=M("img"),o=q(),s=M("div");for(let u=0;u<h.length;u+=1)h[u].c();z(t,"class","has-text-centered has-text-weight-bold"),ve(r.src,i=e[2])||z(r,"src",i),z(r,"alt","qrcode"),z(n,"class","is-flex is-justify-content-center"),z(s,"class","has-text-centered")},m(u,l){E(u,t,l),E(u,a,l),E(u,n,l),_(n,r),E(u,o,l),E(u,s,l);for(let p=0;p<h.length;p+=1)h[p]&&h[p].m(s,null)},p(u,l){if(l&4&&!ve(r.src,i=u[2])&&z(r,"src",i),l&8){f=u[3];let p;for(p=0;p<f.length;p+=1){const v=Fe(u,f,p);h[p]?h[p].p(v,l):(h[p]=Ke(v),h[p].c(),h[p].m(s,null))}for(;p<h.length;p+=1)h[p].d(1);h.length=f.length}},d(u){u&&H(t),u&&H(a),u&&H(n),u&&H(o),u&&H(s),ut(h,u)}}}function zt(e){let t;return{c(){t=M("p"),t.textContent="Please Pass some data"},m(a,n){E(a,t,n)},p:J,d(a){a&&H(t)}}}function jt(e){let t;return{c(){t=M("p"),t.textContent="Loading..."},m(a,n){E(a,t,n)},p:J,d(a){a&&H(t)}}}function Ke(e){let t,a,n,r;function i(){return e[4](e[8])}return{c(){t=M("img"),ve(t.src,a=e[2])||z(t,"src",a),z(t,"width","150"),z(t,"alt",e[7]),j(t,"mr-2",e[10]===0),W(t,"cursor","pointer")},m(o,s){E(o,t,s),n||(r=ue(t,"mousedown",i),n=!0)},p(o,s){e=o},d(o){o&&H(t),n=!1,r()}}}function Wt(e){let t;function a(i,o){if(i[1])return jt;if(!i[0])return zt;if(i[2])return Ot}let n=a(e),r=n&&n(e);return{c(){t=M("div"),r&&r.c(),this.c=J,z(t,"class","mt-5 is-block")},m(i,o){E(i,t,o),r&&r.m(t,null)},p(i,[o]){n===(n=a(i))&&r?r.p(i,o):(r&&r.d(1),r=n&&n(i),r&&(r.c(),r.m(t,null)))},i:J,o:J,d(i){i&&H(t),r&&r.d()}}}function Yt(e,t,a){const n=window.qrcode;let{data:r}=t,i=!1,o;async function s(){a(1,i=!0),a(2,o=await n.toDataURL(r,{width:250})),a(1,i=!1)}const f=[{src:"android.svg",alt:"play-store",url:"https://play.google.com/store/apps/details?id=org.jimber.threebotlogin&hl=en&gl=US"},{src:"ios.svg",alt:"app-store",url:"https://apps.apple.com/us/app/threefold-connect/id1459845885"}],h=u=>window.open(u,"_blank");return e.$$set=u=>{"data"in u&&a(0,r=u.data)},e.$$.update=()=>{e.$$.dirty&1&&r&&s()},[r,i,o,f,h]}class Jt extends ne{constructor(t){super(),ae(this,{target:this.shadowRoot,props:ie(this.attributes),customElement:!0},Yt,Wt,re,{data:0},null),t&&(t.target&&E(t.target,this,t.anchor),t.props&&(this.$set(t.props),Y()))}static get observedAttributes(){return["data"]}get data(){return this.$$.ctx[0]}set data(t){this.$$set({data:t}),Y()}}customElements.define("tf-qrcode",Jt);var Zt=function(t,a){if(a=a.split(":")[0],t=+t,!t)return!1;switch(a){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0},Te={},Qt=Object.prototype.hasOwnProperty,Xt;function Ve(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch{return null}}function He(e){try{return encodeURIComponent(e)}catch{return null}}function xt(e){for(var t=/([^=?#&]+)=?([^&]*)/g,a={},n;n=t.exec(e);){var r=Ve(n[1]),i=Ve(n[2]);r===null||i===null||r in a||(a[r]=i)}return a}function en(e,t){t=t||"";var a=[],n,r;typeof t!="string"&&(t="?");for(r in e)if(Qt.call(e,r)){if(n=e[r],!n&&(n===null||n===Xt||isNaN(n))&&(n=""),r=He(r),n=He(n),r===null||n===null)continue;a.push(r+"="+n)}return a.length?t+a.join("&"):""}Te.stringify=en;Te.parse=xt;var at=Zt,ye=Te,tn=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,rt=/[\n\r\t]/g,nn=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,it=/:\d+$/,an=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,rn=/^[a-zA-Z]:/;function Me(e){return(e||"").toString().replace(tn,"")}var Ce=[["#","hash"],["?","query"],function(t,a){return Q(a.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Oe={hash:1,query:1};function ot(e){var t;typeof window<"u"?t=window:typeof De<"u"?t=De:typeof self<"u"?t=self:t={};var a=t.location||{};e=e||a;var n={},r=typeof e,i;if(e.protocol==="blob:")n=new X(unescape(e.pathname),{});else if(r==="string"){n=new X(e,{});for(i in Oe)delete n[i]}else if(r==="object"){for(i in e)i in Oe||(n[i]=e[i]);n.slashes===void 0&&(n.slashes=nn.test(e.href))}return n}function Q(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function st(e,t){e=Me(e),e=e.replace(rt,""),t=t||{};var a=an.exec(e),n=a[1]?a[1].toLowerCase():"",r=!!a[2],i=!!a[3],o=0,s;return r?i?(s=a[2]+a[3]+a[4],o=a[2].length+a[3].length):(s=a[2]+a[4],o=a[2].length):i?(s=a[3]+a[4],o=a[3].length):s=a[4],n==="file:"?o>=2&&(s=s.slice(2)):Q(n)?s=a[4]:n?r&&(s=s.slice(2)):o>=2&&Q(t.protocol)&&(s=a[4]),{protocol:n,slashes:r||Q(n),slashesCount:o,rest:s}}function on(e,t){if(e==="")return t;for(var a=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=a.length,r=a[n-1],i=!1,o=0;n--;)a[n]==="."?a.splice(n,1):a[n]===".."?(a.splice(n,1),o++):o&&(n===0&&(i=!0),a.splice(n,1),o--);return i&&a.unshift(""),(r==="."||r==="..")&&a.push(""),a.join("/")}function X(e,t,a){if(e=Me(e),e=e.replace(rt,""),!(this instanceof X))return new X(e,t,a);var n,r,i,o,s,f,h=Ce.slice(),u=typeof t,l=this,p=0;for(u!=="object"&&u!=="string"&&(a=t,t=null),a&&typeof a!="function"&&(a=ye.parse),t=ot(t),r=st(e||"",t),n=!r.protocol&&!r.slashes,l.slashes=r.slashes||n&&t.slashes,l.protocol=r.protocol||t.protocol||"",e=r.rest,(r.protocol==="file:"&&(r.slashesCount!==2||rn.test(e))||!r.slashes&&(r.protocol||r.slashesCount<2||!Q(l.protocol)))&&(h[3]=[/(.*)/,"pathname"]);p<h.length;p++){if(o=h[p],typeof o=="function"){e=o(e,l);continue}i=o[0],f=o[1],i!==i?l[f]=e:typeof i=="string"?(s=i==="@"?e.lastIndexOf(i):e.indexOf(i),~s&&(typeof o[2]=="number"?(l[f]=e.slice(0,s),e=e.slice(s+o[2])):(l[f]=e.slice(s),e=e.slice(0,s)))):(s=i.exec(e))&&(l[f]=s[1],e=e.slice(0,s.index)),l[f]=l[f]||n&&o[3]&&t[f]||"",o[4]&&(l[f]=l[f].toLowerCase())}a&&(l.query=a(l.query)),n&&t.slashes&&l.pathname.charAt(0)!=="/"&&(l.pathname!==""||t.pathname!=="")&&(l.pathname=on(l.pathname,t.pathname)),l.pathname.charAt(0)!=="/"&&Q(l.protocol)&&(l.pathname="/"+l.pathname),at(l.port,l.protocol)||(l.host=l.hostname,l.port=""),l.username=l.password="",l.auth&&(s=l.auth.indexOf(":"),~s?(l.username=l.auth.slice(0,s),l.username=encodeURIComponent(decodeURIComponent(l.username)),l.password=l.auth.slice(s+1),l.password=encodeURIComponent(decodeURIComponent(l.password))):l.username=encodeURIComponent(decodeURIComponent(l.auth)),l.auth=l.password?l.username+":"+l.password:l.username),l.origin=l.protocol!=="file:"&&Q(l.protocol)&&l.host?l.protocol+"//"+l.host:"null",l.href=l.toString()}function sn(e,t,a){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(a||ye.parse)(t)),n[e]=t;break;case"port":n[e]=t,at(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,it.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!a;break;case"pathname":case"hash":if(t){var r=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==r?r+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var i=t.indexOf(":");~i?(n.username=t.slice(0,i),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(i+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var o=0;o<Ce.length;o++){var s=Ce[o];s[4]&&(n[s[1]]=n[s[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&Q(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function ln(e){(!e||typeof e!="function")&&(e=ye.stringify);var t,a=this,n=a.host,r=a.protocol;r&&r.charAt(r.length-1)!==":"&&(r+=":");var i=r+(a.protocol&&a.slashes||Q(a.protocol)?"//":"");return a.username?(i+=a.username,a.password&&(i+=":"+a.password),i+="@"):a.password?(i+=":"+a.password,i+="@"):a.protocol!=="file:"&&Q(a.protocol)&&!n&&a.pathname!=="/"&&(i+="@"),(n[n.length-1]===":"||it.test(a.hostname)&&!a.port)&&(n+=":"),i+=n+a.pathname,t=typeof a.query=="object"?e(a.query):a.query,t&&(i+=t.charAt(0)!=="?"?"?"+t:t),a.hash&&(i+=a.hash),i}X.prototype={set:sn,toString:ln};X.extractProtocol=st;X.location=ot;X.trimLeft=Me;X.qs=ye;var un=X;function ze(e){let t,a,n,r;return{c(){t=M("b-notification"),a=M("b-icon"),n=q(),r=pe(e[6]),te(a,"icon","fa-sharp fa-solid fa-triangle-exclamation"),te(t,"color","warning"),te(t,"light",""),j(t,"my-2",!0)},m(i,o){E(i,t,o),_(t,a),_(t,n),_(t,r)},p(i,o){o&64&&Qe(r,i[6])},d(i){i&&H(t)}}}function fn(e){let t,a,n,r,i,o,s,f,h,u,l,p,v,C,D,d,b,A,T,B,y,w;r=new e[13]({props:{label:"Mnemonic",placeholder:"Mnemonic",sublabel:"Mnemonic are your private key. They are used to represent you on the ThreeFold Grid. You can paste existing mnemonic or click the 'Create Account' button to create an account and generate mnemonic.",type:"password",controller:P.get("mnemonic"),disabled:e[11],validation:!(e[12]||e[11]),hint:e[4].pending?"Validating mnemonic...":e[1]==="Error"?e[6]:void 0,hintColor:e[4].pending?"info":e[1]==="Error"?"danger":void 0}});let S=e[1]==="Done"&&e[6]&&ze(e);return C=new e[13]({props:{label:"Public SSH Key",type:"textarea",placeholder:"Your public SSH Key",sublabel:`
        SSH Keys are used to authenticate you to the Threebot Deployer instance for management purposes.
        If you don't have an SSH Key or are not familiar, we can generate one for you.
        `,controller:P.get("sshKey"),loading:e[2]||e[9]||e[3],disabled:!e[4].valid||e[2]||e[9]||e[3],hint:e[8]||(e[2]||e[9]||e[3]?e[7]:void 0),validation:!(e[2]||e[9]||e[3]),hintColor:e[2]||e[9]||e[3]?"info":void 0}}),{c(){t=M("section"),a=M("div"),n=M("div"),L(r.$$.fragment),i=q(),o=M("button"),s=pe("Create Account"),u=q(),S&&S.c(),l=q(),p=M("div"),v=M("div"),L(C.$$.fragment),D=q(),d=M("button"),b=pe("Generate SSH Key"),this.c=J,W(n,"width","100%"),z(o,"type","button"),o.disabled=f=e[4].valid||e[12]||e[11],j(o,"ml-2",!0),W(o,"margin-top","78px"),z(a,"class","is-flex is-jutify-content-center"),W(v,"width","100%"),z(d,"type","button"),d.disabled=A=!e[4].valid||e[2]||e[9]||e[3]||e[5].valid,j(d,"ml-2",!0),W(d,"margin-top","78px"),z(p,"class","is-flex is-jutify-content-center mb-2"),W(t,"display",e[0]?"initial":"none")},m(c,g){E(c,t,g),_(t,a),_(a,n),F(r,n,null),_(a,i),_(a,o),_(o,s),_(t,u),S&&S.m(t,null),_(t,l),_(t,p),_(p,v),F(C,v,null),_(p,D),_(p,d),_(d,b),e[26](t),B=!0,y||(w=[ke(h=e[14].call(null,o,{color:"primary",size:"small",loading:e[12]||e[11]})),ue(o,"click",e[15]),ke(T=e[14].call(null,d,{color:"primary",size:"small",loading:e[2]||e[9]||e[3]})),ue(d,"click",e[16])],y=!0)},p(c,[g]){const G={};g&2048&&(G.disabled=c[11]),g&6144&&(G.validation=!(c[12]||c[11])),g&82&&(G.hint=c[4].pending?"Validating mnemonic...":c[1]==="Error"?c[6]:void 0),g&18&&(G.hintColor=c[4].pending?"info":c[1]==="Error"?"danger":void 0),r.$set(G),(!B||g&6160&&f!==(f=c[4].valid||c[12]||c[11]))&&(o.disabled=f),h&&he(h.update)&&g&6144&&h.update.call(null,{color:"primary",size:"small",loading:c[12]||c[11]}),c[1]==="Done"&&c[6]?S?S.p(c,g):(S=ze(c),S.c(),S.m(t,l)):S&&(S.d(1),S=null);const V={};g&524&&(V.loading=c[2]||c[9]||c[3]),g&540&&(V.disabled=!c[4].valid||c[2]||c[9]||c[3]),g&908&&(V.hint=c[8]||(c[2]||c[9]||c[3]?c[7]:void 0)),g&524&&(V.validation=!(c[2]||c[9]||c[3])),g&524&&(V.hintColor=c[2]||c[9]||c[3]?"info":void 0),C.$set(V),(!B||g&572&&A!==(A=!c[4].valid||c[2]||c[9]||c[3]||c[5].valid))&&(d.disabled=A),T&&he(T.update)&&g&524&&T.update.call(null,{color:"primary",size:"small",loading:c[2]||c[9]||c[3]}),g&1&&W(t,"display",c[0]?"initial":"none")},i(c){B||(I(r.$$.fragment,c),I(C.$$.fragment,c),B=!0)},o(c){N(r.$$.fragment,c),N(C.$$.fragment,c),B=!1},d(c){c&&H(t),K(r),S&&S.d(),K(C),e[26](null),y=!1,Ze(w)}}}function cn(e,t,a){let n,r,i,o,s,f,h;me(e,P,m=>a(25,h=m));let{show:u}=t;const{Input:l,btn:p}=window.tfSvelteBulmaWc,{generateKeyPair:v}=window.webSshKeygen;let C=!1;window.config.network==="main"||window.config.network;let D,d="None",b;async function A(){try{a(1,d="Creating");const{GridClient:m}=window.grid3_client,$=window.config.network,k=new m({mnemonic:"",network:$,storeSecret:"omda"});k._connect();const U=k.getDefaultUrls(window.config.network),O=un(U.relay).hostname,le=await k.tfchain.createAccount(O);P.get("mnemonic").setValue(le.mnemonic),await P.get("mnemonic").validate(),a(6,b="Please make sure to store your mnemonic somewhere safe to be able to access your deployments later on.         There is no way for neither you nor ThreeFold nor anybody else to recover lost mnemonic."),a(1,d="Done"),k.disconnect()}catch(m){a(1,d="Error"),a(6,b=m)}}let T,B=!1,y,w,S=!1,c=!1,g,G=!1;async function V(){a(9,G=!0),a(7,T="Generating Your SSH Key...");const m=await v({alg:"RSASSA-PKCS1-v1_5",hash:"SHA-256",name:"Threefold",size:4096});try{await(await ce(n.value.mnemonic.value)).kvstore.set({key:"metadata",value:JSON.stringify({sshkey:m.publicKey})})}catch(U){a(8,g=U.message)}P.get("sshKey").setValue(m.publicKey),await P.get("sshKey").validate();const $=`data:text/raw;charset=utf-8,${encodeURIComponent(m.privateKey)}`,k=document.createElement("a");k.download="id_rsa",k.href=$,document.body.appendChild(k),k.click(),k.remove(),a(9,G=!1)}let R;window.onresize=x,be(x),Ie(()=>{window.onresize=null});function x(){for(const m of R.children){const $=m.querySelector("button"),k=m.querySelector("input")||m.querySelector("textarea");try{const U=k.getBoundingClientRect().top-m.getBoundingClientRect().top;$&&k&&($.style.marginTop=`${U}px`)}catch{requestAnimationFrame(x)}}}let Z=!1;function ee(m){Ae[m?"unshift":"push"](()=>{R=m,a(10,R)})}return e.$$set=m=>{"show"in m&&a(0,u=m.show)},e.$$.update=()=>{if(e.$$.dirty&33554432&&a(24,n=h),e.$$.dirty&16908288&&P&&(C?fe.write(fe.Keys.Credentials,P.value.mnemonic):requestAnimationFrame(()=>{a(17,C=!0);const m=fe.read(fe.Keys.Credentials);m&&P.get("mnemonic").setValue(m)})),e.$$.dirty&16777216&&a(4,r=n==null?void 0:n.value.mnemonic),e.$$.dirty&16&&a(23,f=r?r.valid||!r.valid&&r.error===bt:!1),e.$$.dirty&25427984&&f&&D!==r.value&&(a(18,D=r.value),ce(n.value.mnemonic.value).then(m=>m.twins.get_my_twin_id()).then(m=>m)),e.$$.dirty&16777216&&a(5,i=n==null?void 0:n.value.sshKey),e.$$.dirty&2621492&&(r==null?void 0:r.valid)&&!(i!=null&&i.valid)&&!B&&!S){a(21,S=!0),a(2,B=!0),a(7,T="Reading Your SSH Key...");const m="metadata";ce(r.value).then(async $=>{const k=await $.kvstore.get({key:m});k!==""&&requestAnimationFrame(()=>{a(19,y=JSON.parse(k).sshkey),a(20,w=r.value),P.get("sshKey").setValue(y.trim())})}).finally(()=>a(2,B=!1))}e.$$.dirty&1572920&&(r==null?void 0:r.valid)&&(i==null?void 0:i.valid)&&((i==null?void 0:i.value)!==y||(r==null?void 0:r.value)!==w)&&!c&&(a(19,y=i.value),a(20,w=r.value),a(3,c=!0),a(7,T="Storing Your SSH Key..."),ce(r.value).then(m=>m.kvstore.set({key:"metadata",value:JSON.stringify({sshkey:y})})).finally(()=>a(3,c=!1))),e.$$.dirty&16&&a(12,o=r==null?void 0:r.pending),e.$$.dirty&2&&a(11,s=d==="Creating"),e.$$.dirty&4194320&&(!r.valid&&Z?(a(22,Z=!1),P.get("sshKey").reset(),a(21,S=!1)):r.valid&&!Z&&a(22,Z=!0))},[u,d,B,c,r,i,b,T,g,G,R,s,o,l,p,A,V,C,D,y,w,S,Z,f,n,h,ee]}class lt extends ne{constructor(t){super(),ae(this,{target:this.shadowRoot,props:ie(this.attributes),customElement:!0},cn,fn,re,{show:0},null),t&&(t.target&&E(t.target,this,t.anchor),t.props&&(this.$set(t.props),Y()))}static get observedAttributes(){return["show"]}get show(){return this.$$.ctx[0]}set show(t){this.$$set({show:t}),Y()}}customElements.define("tf-credentials-tab",lt);function je(e){let t,a,n,r;return t=new xe({props:{deployer:P,show:e[0]==="basic"}}),n=new nt({props:{deployer:P,show:e[0]==="advanced"}}),{c(){L(t.$$.fragment),a=q(),L(n.$$.fragment)},m(i,o){F(t,i,o),E(i,a,o),F(n,i,o),r=!0},p(i,o){const s={};o&1&&(s.show=i[0]==="basic"),t.$set(s);const f={};o&1&&(f.show=i[0]==="advanced"),n.$set(f)},i(i){r||(I(t.$$.fragment,i),I(n.$$.fragment,i),r=!0)},o(i){N(t.$$.fragment,i),N(n.$$.fragment,i),r=!1},d(i){K(t,i),i&&H(a),K(n,i)}}}function We(e){let t;return{c(){t=M("b-notification"),t.innerHTML=`<b-icon icon="fa-solid fa-circle-check"></b-icon>
              Your deployment is up and running.`,te(t,"color","success"),te(t,"light","")},m(a,n){E(a,t,n)},d(a){a&&H(t)}}}function Ye(e){let t,a;return t=new yt({props:{data:e[5]}}),t.$on("close",e[22]),{c(){L(t.$$.fragment)},m(n,r){F(t,n,r),a=!0},p(n,r){const i={};r&32&&(i.data=n[5]),t.$set(i)},i(n){a||(I(t.$$.fragment,n),a=!0)},o(n){N(t.$$.fragment,n),a=!1},d(n){K(t,n)}}}function dn(e){let t,a,n,r,i,o,s,f,h,u,l,p,v,C,D,d,b,A,T=e[2]?"Back":"Deploy",B,y,w,S,c,g,G,V,R,x;function Z(U){e[19](U)}let ee={tabs:[{id:"credentials",label:"Credentials",error:e[10]},...e[11]?[{id:"basic",label:"Basic",error:e[9]},{id:"advanced",label:"Advanced",error:e[8]}]:[]]};e[0]!==void 0&&(ee.active=e[0]),o=new mn({props:ee}),Ae.push(()=>ft(o,"active",Z)),l=new lt({props:{show:e[0]==="credentials"}});let m=e[11]&&je(e),$=e[7]&&We(),k=e[5]&&e[6]&&Ye(e);return{c(){t=M("b-box"),a=M("b-content"),a.innerHTML=`<h2 class="has-text-centered is-size-1 mt-0">Threebot Deployer</h2> 
    <p>Threebot deployer app makes it simple and hassle-free to deploy your own
      web3 proxy, With user-friendly interface, you can create and manage your
      Threebot with ease, while our key management system ensures that your
      authentication and verification processes are secure and reliable. Whether
      you&#39;re a seasoned blockchain developer or just starting out, our deployer
      app streamlines the deployment process so that you can focus on what
      matters most - building and deploying your web3 proxy.</p> 
    <hr/>`,n=q(),r=M("section"),i=M("section"),L(o.$$.fragment),f=q(),h=M("form"),u=M("section"),L(l.$$.fragment),p=q(),m&&m.c(),v=q(),C=M("section"),D=M("tf-terminal"),d=q(),b=M("div"),A=M("button"),B=pe(T),c=q(),g=M("div"),$&&$.c(),G=q(),k&&k.c(),this.c=J,j(i,"d-none",e[2]),W(i,"margin-top","35px"),j(u,"d-none",e[2]),j(C,"d-none",!e[2]),z(A,"type",y=e[2]?"button":"submit"),A.disabled=w=e[10]||e[2]&&!e[3]&&!e[4]||e[5]||e[6],j(A,"py-0",!0),z(g,"class","ml-2"),W(g,"width","100%"),z(b,"class","is-flex mt-2 is-align-items-center"),z(h,"class","p-2"),j(t,"p-6",!0),j(t,"mt-5",!0),j(t,"is-size-5",!0),W(t,"font-family","'Lato', sans-serif")},m(U,O){E(U,t,O),_(t,a),_(t,n),_(t,r),_(r,i),F(o,i,null),_(r,f),_(r,h),_(h,u),F(l,u,null),_(u,p),m&&m.m(u,null),_(h,v),_(h,C),_(C,D),e[20](D),_(h,d),_(h,b),_(b,A),_(A,B),_(b,c),_(b,g),$&&$.m(g,null),_(t,G),k&&k.m(t,null),V=!0,R||(x=[ke(S=e[12].call(null,A,{color:e[2]?"info":"primary",loading:e[2]&&!e[3]&&!e[4]})),ue(A,"click",function(){he(e[2]?e[21]:void 0)&&(e[2]?e[21]:void 0).apply(this,arguments)}),ue(h,"submit",ct(e[13]))],R=!0)},p(U,[O]){e=U;const le={};O&3840&&(le.tabs=[{id:"credentials",label:"Credentials",error:e[10]},...e[11]?[{id:"basic",label:"Basic",error:e[9]},{id:"advanced",label:"Advanced",error:e[8]}]:[]]),!s&&O&1&&(s=!0,le.active=e[0],dt(()=>s=!1)),o.$set(le),(!V||O&4)&&j(i,"d-none",e[2]);const Ne={};O&1&&(Ne.show=e[0]==="credentials"),l.$set(Ne),e[11]?m?(m.p(e,O),O&2048&&I(m,1)):(m=je(e),m.c(),I(m,1),m.m(u,null)):m&&(oe(),N(m,1,1,()=>{m=null}),se()),(!V||O&4)&&j(u,"d-none",e[2]),(!V||O&4)&&j(C,"d-none",!e[2]),(!V||O&4)&&T!==(T=e[2]?"Back":"Deploy")&&Qe(B,T),(!V||O&4&&y!==(y=e[2]?"button":"submit"))&&z(A,"type",y),(!V||O&1148&&w!==(w=e[10]||e[2]&&!e[3]&&!e[4]||e[5]||e[6]))&&(A.disabled=w),S&&he(S.update)&&O&28&&S.update.call(null,{color:e[2]?"info":"primary",loading:e[2]&&!e[3]&&!e[4]}),e[7]?$||($=We(),$.c(),$.m(g,null)):$&&($.d(1),$=null),e[5]&&e[6]?k?(k.p(e,O),O&96&&I(k,1)):(k=Ye(e),k.c(),I(k,1),k.m(t,null)):k&&(oe(),N(k,1,1,()=>{k=null}),se())},i(U){V||(I(o.$$.fragment,U),I(l.$$.fragment,U),I(m),I(k),V=!0)},o(U){N(o.$$.fragment,U),N(l.$$.fragment,U),N(m),N(k),V=!1},d(U){U&&H(t),K(o),K(l),m&&m.d(),e[20](null),$&&$.d(),k&&k.d(),R=!1,Ze(x)}}}const{Tabs:mn}=window.tfSvelteBulmaWc,{events:Je}=window.grid3_client;function Se(...e){for(const t of e)if(!t.valid&&(t.touched||t.dirty))return!0;return!1}function pn(e,t,a){let n,r,i,o,s,f,h,u,l,p;me(e,mt,R=>a(24,l=R)),me(e,P,R=>a(18,p=R));const{btn:v}=window.tfSvelteBulmaWc;let C="credentials",D,d=!1,b=!1,A=!1,T="",B,y=!1,w=!1;async function S(){var x,Z,ee;const{value:R}=P;try{await wt(R.mnemonic,R.nodeId)}catch{await P.get("nodeId").validate(),P.get("certified").setValue(n.value.certified.value)}if(!P.valid){P.markAsDirty(),P.markAsTouched(),requestAnimationFrame(()=>{h?requestAnimationFrame(()=>{a(0,C="basic"),requestAnimationFrame(()=>{var m;s.name.valid||(m=P.get("name").__input)==null||m.focus()})}):u&&requestAnimationFrame(()=>{a(0,C="advanced"),requestAnimationFrame(()=>{var m,$,k;s.cpu.valid?s.memory.valid?s.disk.valid||(k=P.get("disk").__input)==null||k.focus():($=P.get("memory").__input)==null||$.focus():(m=P.get("cpu").__input)==null||m.focus()})})});return}a(2,d=!0),(x=window.deploymentList)==null||x.setDisabled(!0),a(3,b=!1),a(4,A=!1);try{Je.addListener("logs",O=>(T=O,D.commit("Deployment stage",T,we.requested)));const m=await _t(R.mnemonic,R.name),[$,k]=R.gateway.split(":"),U=await St({...P.value,image:{flist:P.value.flist,entryPoint:P.value.entryPoint},rootFsSize:2,disks:[{name:de(5,"disk"),mountPoint:"/var/lib/docker",size:R.disk}],envs:[{key:"SSH_KEY",value:R.sshKey},{key:"TFCHAIN_KEY",value:R.mnemonic},{key:"ETH_PUBLIC_KEY",value:l},{key:"LOCAL_DOMAIN",value:`${m}.${k}`},{key:"DB_PASSWORD",value:de(3,"password")},{key:"SITE_URL",value:`https://${m}.${k}/`},{key:"MATTERMOST_DOMAIN",value:`${m}.${k}`},{key:"SMTPUsername",value:de(5,"user")},{key:"SMTPPassword",value:de(5,"password@")},{key:"SMTPServer",value:"smtp.gmail.com"},{key:"SMTPPort",value:"8000"}],metadata:JSON.stringify({type:"vm",name:P.value.name,projectName:"ThreebotDeployer"})});await vt({domainName:m,mnemonic:R.mnemonic,planetaryIp:U[0].planetary,publicNodeId:+$,metadata:JSON.stringify({type:"gateway",name:m,projectName:"ThreebotDeployer"})}),a(5,B=U),a(4,A=!0),T="Successfully deployed.",D.commit("Deployment stage",T,we.success),(Z=window.deploymentList)==null||Z.reload(),(ee=window.deploymentList)==null||ee.setDisabled(!1),a(7,w=!0),a(6,y=!0)}catch(m){console.log(m),T=m.message,D.commit("Deployment stage",T,we.failed),a(3,b=!0)}Je.removeAllListeners("logs")}function c(R){C=R,a(0,C)}function g(R){Ae[R?"unshift":"push"](()=>{D=R,a(1,D)})}const G=R=>{R.preventDefault(),a(2,d=!1),a(4,A=!1),a(3,b=!1),a(7,w=!1)},V=()=>{a(5,B=void 0),a(6,y=!1)};return e.$$.update=()=>{e.$$.dirty&262144&&a(15,n=p),e.$$.dirty&32768&&a(17,r=n.value.mnemonic),e.$$.dirty&32768&&a(16,i=n.value.sshKey),e.$$.dirty&196608&&a(11,o=r.valid&&i.valid),e.$$.dirty&32768&&a(14,s=n.value),e.$$.dirty&16384&&a(10,f=Se(s.mnemonic,s.sshKey)),e.$$.dirty&16384&&a(9,h=Se(s.name,s.region,s.flist,s.entryPoint,s.certified)),e.$$.dirty&16384&&a(8,u=Se(s.cpu,s.memory,s.disk,s.gateway,s.nodeId))},[C,D,d,b,A,B,y,w,u,h,f,o,v,S,s,n,i,r,p,c,g,G,V]}class hn extends ne{constructor(t){super(),ae(this,{target:this.shadowRoot,props:ie(this.attributes),customElement:!0},pn,dn,re,{},null),t&&t.target&&E(t.target,this,t.anchor)}}customElements.define("tf-deployer",hn);export{hn as default};
